(function(e){function n(e){e+="";return e.replace(/[\s+|\.|\-]/g,"")}function r(){if(!(this instanceof r)){return new r}}var t=e.moip||{};e.moip=t;r.prototype={isValid:function(e){var t=r.prototype.cardType(e);e=n(e);if(!t){return false}else if(t.brand==="HIPERCARD"){return true}else{var i=0;for(var s=2-e.length%2;s<=e.length;s+=2){i+=parseInt(e.charAt(s-1),10)}for(s=e.length%2+1;s<e.length;s+=2){var o=parseInt(e.charAt(s-1),10)*2;if(o<10){i+=o}else{i+=o-9}}if(i%10===0){return true}else{return false}}},cardType:function(e,t){var r,i,s={VISA:/^4\d{3}-?\d{4}-?\d{4}-?\d{4}$/,MASTERCARD:/^5[1-5]\d{2}-?\d{4}-?\d{4}-?\d{4}$/,AMEX:/^3[4,7]\d{13}$/,DINERS:/^3[0,6,8]\d{12}$/,HIPERCARD:/^(606282\d{10}(\d{3})?)|(3841\d{15})$/,ELO:/^(506(699|7[0-6][0-9]|77[0-8])|509([0-9][0-9][0-9])|636368|636297|504175|438935|401179|401178|457631|457632|451416|627780|457393|431274)/},o={VISA:/^4\d{3}-?\d{2}/,MASTERCARD:/^5[1-5]\d{2}-?\d{2}/,AMEX:/^3[4,7]\d{2}/,DINERS:/^3(?:0[0-5]|[68][0-9])+/,HIPERCARD:/^606282|3841\d{2}/,ELO:/^(506(699|7[0-6][0-9]|77[0-8])|509([0-9][0-9][0-9])|636368|636297|504175|438935|401179|401178|457631|457632|451416|627780|457393|431274)/};e=n(e);if(t){s=o}for(r in s){if(s.hasOwnProperty(r)&&e.match(s[r])){i={brand:r}}}return i},isSecurityCodeValid:function(e,n){var r=t.creditCard.cardType(e),i;i=r.brand==="AMEX"?4:3;var s=new RegExp("[0-9]{"+i+"}");return n.length===i&&s.test(n)},isExpiryDateValid:function(e,t){e=parseInt(e,10);t=parseInt(t,10);if(e<1||e>12){return false}if((t+"").length!==2&&(t+"").length!==4){return false}if((t+"").length===2){if(t>80){t="19"+t}else{t="20"+t}}if(t<1e3||t>=3e3){return false}return!r.prototype.isExpiredDate(e,t)},isExpiredDate:function(e,t){var n=new Date;var r=("0"+(n.getMonth()+1)).slice(-2);var i=n.getFullYear();e=("0"+e).slice(-2);if(t.toString().length===2){if(t>80){return true}else{t="20"+t}}var s=i+r;var o=t+e;return parseInt(o,10)<parseInt(s,10)}};t.creditCard=r()})(window);(function(e){var t=e.moip||{};e.moip=t;t.calculator={pricing:function(e){return this.buildJson(e)},buildJson:function(e){var t;var n=[];var r=[];var i=[];var s=[];t=this._calculateTransactionTax(e.amount,e.transaction_percentage,e.fixed);if(e.antecipation_percentage!==undefined&&e.floating!==undefined&&e.installment!==undefined){for(var o=0;o<=11;o++){n[o]=this._calculateInstallmentValue(e.amount,o+1);r[o]=this._calculateAntecipationPercentage(t,e,o,e.amount);i[o]=this._calculateTotalTax(r[o],t);s[o]=this._calculateLiquidValue(e.amount,i[o])}return{amount:e.amount,transaction_tax:t,antecipation_percentage:r,total_tax:i,liquid_value:s,installment_value:n}}else{s=this._calculateLiquidValue(e.amount,t);return{amount:e.amount,transaction_tax:t,liquid_value:s}}},pricingWithInterest:function(e){var t=[];var n=[];var r=[];var i=[];var s=[];var o=[];var u=[];for(var a=1;a<=12;a++){t[a-1]=this._calculateInterestRate(e.amount,e.interest_rate,a);n[a-1]=this._calculateAmount(t[a-1],a);r[a-1]=this._calculateTransactionTax(n[a-1],e.transaction_percentage,e.fixed);i[a-1]=this._calculateAntecipationPercentage(r[a-1],e,a-1,n[a-1]);s[a-1]=this._calculateAntecipationPercentageFromAmount(n[a-1],i[a-1]);o[a-1]=this._calculateTotalTax(i[a-1],r[a-1]);u[a-1]=this._calculateLiquidValue(n[a-1],o[a-1])}return{amount:n,transaction_tax:r,antecipation_percentage:s,total_tax:o,liquid_value:u,installment_value:t}},_calculateAntecipationPercentageFromAmount:function(e,t){return parseFloat(t*100/(e/100)).toFixed(2)},_calculateTransactionTax:function(e,t,n){return parseFloat(((e*(t/100)+n)/100).toFixed(2))},_calculateAntecipationPercentage:function(e,t,n,r){return parseFloat((parseFloat(t.antecipation_percentage/100/30*(30+n*15-t.floating))*parseFloat(r/100-e)).toFixed(2))},_calculateTotalTax:function(e,t){return parseFloat((e+t).toFixed(2))},_calculateLiquidValue:function(e,t){return parseFloat((e/100-parseFloat(t)).toFixed(2))},_calculateInstallmentValue:function(e,t){return parseFloat((e/t/100).toFixed(2))},_calculateInterestRate:function(e,t,n){if(n===1){return parseFloat(e/100)}return parseFloat((this._coefficient(t,n)*(e/100)).toFixed(2))},_calculateAmount:function(e,t){return parseFloat((e*t).toFixed(2)*100)},_coefficient:function(e,t){return parseFloat((e/100/(1-1/Math.pow(e/100+1,t))).toFixed(10))}}})(window)	